<script>
document.addEventListener("DOMContentLoaded", function() {

  // 1. Linkleri Yeni Sekmede Açma
  var links = document.links;
  for (var i = 0; i < links.length; i++) {
    if (links[i].hostname != window.location.hostname) {
      links[i].target = '_blank';
      links[i].rel = 'noopener noreferrer';
    } else if (links[i].href.endsWith(".pdf")) {
      links[i].target = '_blank';
    }
  }
});

// 2. AKILLI DİL DEĞİŞTİRİCİ (Capture Phase Modu)
// 'true' parametresi ile olayı en tepede yakalıyoruz.
window.addEventListener('click', function(e) {
  
  var link = e.target.closest('a');
  if (!link) return;

  // Linkin tam adresi (örn: https://site.com/en/) ve sayfa yolu
  var href = link.getAttribute('href'); 
  var currentPath = window.location.pathname;

  // Güvenlik kontrolü: href boşsa çık
  if (!href) return;

  // SENARYO A: TR sayfasındayız -> İngilizce butonuna basıldı
  // Hem "/en/" hem de "/en" ihtimallerini kontrol ediyoruz
  if ((href === '/en/' || href === '/en') && currentPath.indexOf('/tr/') !== -1) {
    
    // Eğer sadece anasayfada değilsek (/tr/ ise değiştirme, /tr/projects/ ise değiştir)
    if (currentPath.length > 4) {
      e.preventDefault();
      e.stopPropagation(); // Diğer scriptleri sustur
      var newPath = currentPath.replace('/tr/', '/en/');
      window.location.href = newPath;
    }
  }

  // SENARYO B: EN sayfasındayız -> Türkçe butonuna basıldı
  else if ((href === '/tr/' || href === '/tr') && currentPath.indexOf('/en/') !== -1) {
    
    if (currentPath.length > 4) {
      e.preventDefault();
      e.stopPropagation(); // Diğer scriptleri sustur
      var newPath = currentPath.replace('/en/', '/tr/');
      window.location.href = newPath;
    }
  }

}, true); // <--- İŞTE SİHİRLİ ANAHTAR (Capture Mode)
</script>