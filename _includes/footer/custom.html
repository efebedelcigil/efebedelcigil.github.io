<script>
document.addEventListener("DOMContentLoaded", function() {

  // 1. GÖREV: Dış Linkleri Yeni Sekmede Açma (Bu zaten çalışıyordu)
  var links = document.links;
  for (var i = 0; i < links.length; i++) {
    if (links[i].hostname != window.location.hostname) {
      links[i].target = '_blank';
      links[i].rel = 'noopener noreferrer';
    } else if (links[i].href.endsWith(".pdf")) {
      links[i].target = '_blank';
    }
  }

  // 2. GÖREV: AKILLI DİL DEĞİŞTİRİCİ (INTERCEPTOR V2.0)
  // Linkleri önceden değiştirmek yerine, tıklama anında yakalıyoruz.
  document.body.addEventListener('click', function(e) {
    
    // Tıklanan öğe bir link mi (veya linkin içindeki bir ikon mu)?
    var link = e.target.closest('a');
    if (!link) return; // Link değilse işlem yapma

    var href = link.getAttribute('href'); // Linkin hedefi ne?
    var currentPath = window.location.pathname; // Şu an neredeyiz?

    // SENARYO A: TR sayfasındayız, "English" (/en/) butonuna tıklandı
    if (href === '/en/' && currentPath.indexOf('/tr/') !== -1) {
      // Sadece anasayfadaysak (/tr/) karışma, ama alt sayfadaysak (/tr/projects/) müdahale et
      if (currentPath.length > 4) { 
        e.preventDefault(); // Standart gitmeyi durdur
        var newPath = currentPath.replace('/tr/', '/en/');
        window.location.href = newPath; // Yeni adrese manuel gönder
      }
    }

    // SENARYO B: EN sayfasındayız, "Türkçe" (/tr/) butonuna tıklandı
    else if (href === '/tr/' && currentPath.indexOf('/en/') !== -1) {
      if (currentPath.length > 4) {
        e.preventDefault(); // Standart gitmeyi durdur
        var newPath = currentPath.replace('/en/', '/tr/');
        window.location.href = newPath; // Yeni adrese manuel gönder
      }
    }

  });
});
</script>